Нам необходимо решить антагонистическую матричную игру.
**Игрой** с математической точки зрения называется тройка <X, Y, F(x, y)>, где X = {X1, ..., Xn} и Y = {Y1, ..., Yn} - множества стратегий первого и второго игроков соотвественно, а F(x,y) - это **функция выигрыша**. Матрица, в которой строки соответсвуют стратегиям игрока X, а столбцы - стратегиям игрока Y, элементами a(i, j) которой являются результаты игры при i-й стратегии игрока X и j-й стратегии игрока Y, называется **матрицей выигрышей**. Матричная игра называется **антагонистической**, если в ней участвуют два игрока и значения функций выигрыша в каждой ситуации равны по величине, но противоположны по знаку  (весь проигрыш одного игрока является выигрышем другого). Нужно найти значение игры и оптимальные стратегии первого и второго игроков при заданной матрице.
# Ход решения

**Чистая стратегия** - возможный ход игрока, выбранный с вероятностью 1. Для каждого игрока возникает вопрос увеличения выигрыша (уменьшения проигрыша). Это можно сделать применяя **смешанные стратегии** - вероятностное распределение на множестве X для первого игрока (Y - для второго). 

 1.  Не ограничивая общности, приведем матрицу к удобному виду: если в ней есть  отрицательные элементы, то прибавив модуль наименьшего элемента матрицы, мы получаем неотрицательную матрицу. Тогда мы можем сказать, что **цена игры** положительна: v > 0. 
 2.	Рассмотрим смешанные стратегии p=(p<sub>1</sub>,...,p<sub>m</sub>) и q=(q<sub>1</sub>,...,q<sub>n</sub>), где компоненты этих векторов - вероятность применения чистых стратегий i и j первым и вторым игроками соответственно. p<sub>1</sub>+p<sub>2</sub>+...+p<sub>m</sub> = 1;  
 q<sub>1</sub>+q<sub>2</sub>+...+q<sub>n</sub> = 1.
3.	Найдем оптимальную стратегию первого игрока. Она должна обеспечить ему выигрыш >= v при любом поведении второго игрока. Значит, должна выполняться система неравенств: 

	 a<sub>11</sub> p<sub>1</sub> + a<sub>21</sub> p<sub>2</sub> + ... + a<sub>m1</sub> p<sub>m</sub> >= v  
	 a<sub>12</sub> p<sub>1</sub> + a<sub>22</sub> p<sub>2</sub> + ... + a<sub>m2</sub> p<sub>m</sub> >= v  
	 			...  
	 a<sub>1n</sub> p<sub>1</sub> + a<sub>2n</sub> p<sub>2</sub> + ... + a<sub>mn</sub> p<sub>m</sub> >= v  
	 
	 Разделим все неравенства на v:   
	 
	 a<sub>11</sub> p<sub>1</sub>/v + a<sub>21</sub> p<sub>2</sub>/v + ... + a<sub>m1</sub> p<sub>m</sub>/v >= 1  
	 a<sub>12</sub> p<sub>1</sub>/v + a<sub>22</sub> p<sub>2</sub>/v + ... + a<sub>m2</sub> p<sub>m</sub>/v >= 1  
	 			...  
	 a<sub>1n</sub> p<sub>1</sub>/v + a<sub>2n</sub> p<sub>2</sub>/v + ... + a<sub>mn</sub> p<sub>m</sub>/v >= 1   
	 
	Заменив p<sub>i</sub>/v на y<sub>i</sub>, i =1,2,...,m получим задачу линейного программирования для первого игрока:  
	
	 min <- F(x,y*) = y<sub>1</sub>+y<sub>2</sub>+...+y<sub>m</sub>   
	 y=(y<sub>1</sub>,...,y<sub>m</sub>)  
								
	 a<sub>11</sub> y<sub>1</sub> + a<sub>21</sub> y<sub>2</sub> + ... + a<sub>m1</sub> y<sub>m</sub> >= 1  
	 a<sub>12</sub> y<sub>1</sub> + a<sub>22</sub> y<sub>2</sub> + ... + a<sub>m2</sub> y<sub>m</sub> >= 1    
	 			...  
	 a<sub>1n</sub> y<sub>1</sub> + a<sub>2n</sub> y<sub>2</sub> + ... + a<sub>mn</sub> y<sub>m</sub> >= 1  
	 
	 Аналогично получим задачу для второго игрока:  
	 
	 max <- F(x*,y) = x<sub>1</sub>+x<sub>2</sub>+...+x<sub>m</sub>   
	 x=(x<sub>1</sub>,...,x<sub>m</sub>)  
								
	 a<sub>11</sub> x<sub>1</sub> + a<sub>21</sub> x<sub>2</sub> + ... + a<sub>m1</sub> x<sub>m</sub> <= 1  
	 a<sub>12</sub> x<sub>1</sub> + a<sub>22</sub> x<sub>2</sub> + ... + a<sub>m2</sub> x<sub>m</sub> <= 1    
	 			...  
	 a<sub>1n</sub> x<sub>1</sub> + a<sub>2n</sub> x<sub>2</sub> + ... + a<sub>mn</sub> x<sub>m</sub> <= 1  
	   
	 Для того, чтобы найти решение в смешанных стратегиях используем функцию linprog, которая с помощью **симплекс-метода** находит искомое решение. 
	     
Суть метода
----------------
Алгоритм симплекс-метода заключается в том, что из множества вершин, принадлежащих границе множества решений системы неравенств, выбирается такая вершина, в которой значение целевой функции достигает максимума (минимума). По определенному правилу находится начальный опорный план (нулевое решение) и проверяется на оптимальность. Если план оптимален, то задача решена. Если нет, то переходим к другой вершине. Значение целевой функции будет заведомо лучше, чем в предыдущей. Переход от одной вершины к другой осуществляется с помощью вычислений, которые удобно записывать в виде так называемых симплекс-таблицами. Так как вершин конечное число, то и к оптимальному решению мы приходим за конечное число шагов.

Шаги:

* **Шаг 1. Составление симплекс-таблицы.** Перейдем к канонической форме задачи линейного программирования. Запишем ее в симплекс-таблицу. Количество строчек в таблице соответвует количеству равенств в системе ограничений, а столбцов - количеству свободных переменных. Базисные переменные заполняют первый столбец, свободные - верхнюю строку таблицы. Нижняя строка называется индексной, в ней записываются коэффициенты при переменных в целевой функции. В правом нижнем углу первоначально записывается 0, если в функции нет свободного члена; если есть, то он записывается с противоположным знаком. На этом месте (в правом нижнем углу) будет значение целевой функции, которое при переходе от одной таблицы к другой должно увеличиваться по модулю.
    
* **Шаг 2. Проверка на оптимальность.** Проверяем на положительность элементы строки целевой функции. Если найдется хотя бы один отрицательный коэффициент индексной строки, то план необходимо улучшить: из отрицательных коэффициентов индексной строки выбирается наибольший по абсолютной величине. Затем элементы столбца свободных членов симплексной таблицы делит на элементы того же знака ведущего столбца. Далее идет построение нового опорного плана. Пересчетсимплекс-таблицы осуществляется методом Жордана—Гаусса.
Если в нижней строке и в столбце свободных членов все элементы положительные, то *оптимальное решение найдено*. 
	 

	 
